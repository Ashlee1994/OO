# 面向对象课程设计-项目总结报告 #

### <li>  甲方：选课系统 </li> ###
- <a href= "https://github.com/Ashlee1994/OO/blob/master/%E4%BD%9C%E4%B8%9A2/%E4%BD%9C%E4%B8%9A2%EF%BC%9A%E9%80%89%E8%AF%BE%E7%B3%BB%E7%BB%9F%E9%9C%80%E6%B1%82%E8%AF%B4%E6%98%8E%E4%B9%A6.pdf">需求说明书</a>

- <a href= "https://github.com/locusxt/oo/blob/master/hw5/%E9%80%89%E8%AF%BE%E7%B3%BB%E7%BB%9FOOA.md">系统分析报告</a>

- <a href= "https://github.com/locusxt/oo/blob/master/hw6/%E9%80%89%E8%AF%BE%E7%B3%BB%E7%BB%9FOOD.md">系统设计报告</a>

- <a href= "https://github.com/Ashlee1994/OO/blob/master/%E4%BD%9C%E4%B8%9A8/%E4%BD%9C%E4%B8%9A8%EF%BC%9A%E9%9C%80%E6%B1%82%E5%8F%98%E6%9B%B4.md">需求变更报告</a>

- <a href= "https://github.com/locusxt/oo/blob/master/hw9/%E9%80%89%E8%AF%BE%E7%B3%BB%E7%BB%9F%E9%9C%80%E6%B1%82%E5%8F%98%E6%9B%B4.md">应对需求变更报告</a>

### <li>  乙方：图书交易系统 </li> ###

- <a href= "https://github.com/liberion1994/oo/blob/master/%E4%BD%9C%E4%B8%9A2/%E4%BD%9C%E4%B8%9A2-%E5%9B%BE%E4%B9%A6%E4%BA%A4%E6%98%93%E5%B9%B3%E5%8F%B0%E7%9A%84%E5%8A%9F%E8%83%BD%E9%9C%80%E6%B1%82.md">需求说明书</a>

- <a href= "https://github.com/Ashlee1994/OO/blob/master/%E4%BD%9C%E4%B8%9A6/%E4%BD%9C%E4%B8%9A6%EF%BC%9A%E7%B3%BB%E7%BB%9F%E8%AE%BE%E8%AE%A1.md">系统设计报告</a>

- <a href= "https://github.com/Ashlee1994/OO/blob/master/%E4%BD%9C%E4%B8%9A7/%E4%BD%9C%E4%B8%9A7%EF%BC%9A%E7%B3%BB%E7%BB%9F%E5%AE%9E%E7%8E%B0.md">系统实现报告</a>

- <a href= "https://github.com/liberion1994/oo/blob/master/%E4%BD%9C%E4%B8%9A8/%E5%9B%BE%E4%B9%A6%E4%BA%A4%E6%98%93%E5%B9%B3%E5%8F%B0%EF%BC%88%E9%9C%80%E6%B1%82%E5%8F%98%E6%9B%B4%EF%BC%89.md">需求变更说明报告</a> 

- <a href= "https://github.com/Ashlee1994/OO/blob/master/%E4%BD%9C%E4%B8%9A9/%E4%BD%9C%E4%B8%9A9%EF%BC%9A%E5%BA%94%E5%AF%B9%E9%9C%80%E6%B1%82%E5%8F%98%E6%9B%B4.md">应对需求变更报告</a>


## 作为甲方：选课系统总结 ##

### 一. 需求 ##
选课系统是一个非常经典的面向对象设计课题，在我们这个选题中，并没有加入太多的创新元素，主要是想能够让乙方了解面向对象的设计过程与实现，主要角色有三个，分别是学生，教师，教务员。主要实现的功能如下：
<li>**学生：**</li>

- 系统能够处理选课和补退选情况
- 系统能够列出课表使学生能方便知道自己目前的选课状况
- 系统能够自动帮学生判断选课冲冲突的情况
- 系统能够检验学分数是否超过或不足

<li>**教师：**</li>

- 教师能新增课程
- 教师能修改课程数据
- 具有选课人员的筛选及人数上限设定功能
- 教师能查询修课学生的信息

<li>**教务员：**</li>

- 对教师和学生的基本信息和权限进行修改
- 课程超出容纳人数时抽签
- 本系科课程预选功能


### 二. 需求变更 ###
由于乙方两位同学对于选课系统的实现进度不一致，所以需求变更针对两位同学有所不同。但是由于在写需求变更文档时乙方没有完成很多需求功能，因此我们在需求变更中也主要是要求乙方主要晚上选课系统需求文档里面的功能。
#### 朱霆 ####
<li> 课程管理描述-希望在课程管理描述内新增上课大纲，评分标准与课程分数分布的图表</li>
<li> 登录系统页面-登陆框靠右，左侧放学校的图片</li>

<li> 目前的界面上学生、教师、教务三者同在，无法区分目前使用者身份</li>

<li> 学生：系统能够自动帮学生判断课程冲突情况、检验学分超过或不足、查看往年选课信息与成绩，包括学分统计，应修学分，已完成学分，必修学分和选修学分</li>

<li> 教师：添加修改自己的课程的功能、筛选选课学生与人数限制</li>

<li> 教务员：添加预选功能 </li>


#### 华晨彦 ####
<li> 课程管理描述-希望在课程管理描述内新增上课大纲，评分标准与课程分数分布的图表</li>

<li> 学生：系统能够自动帮学生判断课程冲突情况、检验学分超过或不足、查看往年选课信息与成绩，包括学分统计，应修学分，已完成学分，必修学分和选修学分</li>

<li> 查看往年选课信息，包括学分统计，应修学分，已完成学分，必修学分和选修学分</li>

<li> 教务员： 对教师和学生的基本信息和权限进行修改 </li>
 
## 作为乙方：图书交易平台-项目总结报告 ##
### 一. 甲方需求 ###

#### 1. 买家角度应有的功能 ####

- 用户系统：包括注册、登陆、设置个人信息；个人信息包括头像、用户名、邮箱等
- 浏览书目：在不用登陆的情况下也可以浏览
- 搜索功能：用关键字对图书进行检索
- 排序功能：支持按价格、上架时间、购买量排序
- 购买：需要先登录，购买书籍，在线支付
- 收藏：需要先登录，收藏书籍
- 向卖家留言：向卖家咨询书籍相关信息
- 查看订单：包括查看历史订单、当前交易订单状态、确认收货等

#### 2. 卖家角度应用的功能 ####

- 用户系统：包括注册、登陆、设置个人信息，以及提交成为卖家的申请；个人信息包括头像、用户名、邮箱等
- 发布书籍出售信息：由于系统中图书这一领域较为明确，发布的出售信息中也较为明确，包括书名、作者、出版社、ISBN编号、封一封二等所有图书共有的信息。此外，还要包括出售的价格、存货、书是否为全新、书的其他描述等。
- 浏览：同买家
- 编辑已发布的出售信息：包括修改出售信息的某一字段、撤回出售信息
- 查看订单：查看买方用户已经确认的订单，订单中包括订单号、地址、联系方式、留言等信息
- 发货：对某一订单进行线下发货后，在线上进行发货操作，这会使得存货自动减去订单中相应的数量
- 回复用户留言：对用户提出的与书籍相关的问题进行回复

#### 3. 管理员角度应有的功能 ####

* 登陆：不需要注册
* 浏览：同买家
* 管理卖家：包括审核卖家资格、吊销违反规定的卖家资格等
* 删除条目：删除违反规定的在售书籍


### 二. 系统设计 ###
#### 系统类图 ####
![](http://i.imgur.com/IYdi8H3.png)

### 三. 系统实现(已完成的功能) ###

#### 1. 买家部分 ####
- 买家注册，登录
- 买家浏览，搜索图书
- 购买图书
- 添加书籍到购物车，修改购物车
- 查看订单信息
- 申请退货
- 退货过程中发货
- 申请仲裁

#### 2. 卖家部分 ####
- 卖家注册，登录
- 卖家浏览，搜索图书
- 发布图书信息
- 查看订单信息（查看所有订单，按照订单状态查询订单 ）
- 处理买家订单
- 购买图书
- 查看自己购买的订单信息
- 查看自己店铺的图书信息
- 添加书籍到购物车，修改购物车
- 同意/拒绝买家退货
- 收取买家退货物件

#### 3. 管理员部分 ####
- 登录 
- 修改用户信息
- 搜索、浏览图书信息
- 增加图书类别 
- 删除、修改图书信息 
- 修改订单信息 
- 仲裁申请退货订单，并根据结果对买家或卖家进行扣除信用分数惩罚

### 四. 需求变更 ###
#### 1. 买家部分 ####
- 申请退货：买家在确认收货后，如发现商品存在质量问题，可以发起退货，经卖家同意后开始一次退货，退货的钱款、运费等均由双方协商。为了方便实现，退货以完整订单为最小单位，退货的状态应该反映在订单状态中，包括“买家已发起”、“卖家已通过”、“买家已发货”和“退货完成”状态，退货过程类似于买家卖家呼唤身份的一次“购物”行为。
- 申请仲裁：买家申请退货被卖家拒绝后，可以向管理员提交仲裁单申请仲裁，仲裁单应包括原订单、退款金额、退货理由、商品照片等（实现中可暂不考虑照片）。

#### 2. 卖家部分 ####
- 同意退货：对用户发起的退货请求，可以同意或拒绝退货，同时可以修改退货申请中的退款金额，一旦同意退货，将从商家账户扣除相应钱款（实现中可暂不考虑扣款）
- 确认收到退货：确认收到退货后，一次退货订单即完成，同时钱将退回买家账户（实现中可暂不考虑退款）

#### 3. 管理员部分 ####
- 仲裁：管理员接到买家提出的退款仲裁后，可以与卖家沟通后作出仲裁，仲裁的结果有三种：
  1. 沟通成功，卖家同意退款，退货进入“卖家已通过”状态，按正常流程进行退货；
  2. 沟通失败，卖家拒不退货，该次退货关闭，但会对卖家进行信誉、保证金等方面进行惩罚（可暂不实现惩罚机制）
  3. 多次沟通后，仲裁认为买家请求是无理的，驳回申请，关闭该次退货，同时本次买家行为将被记录，对屡次提出无理退货请求的买家，将给予惩罚（可暂不实现惩罚机制）

### 五. 应对需求变更 ###
#### 1. 买家 ####

- 应对这一需求，在设计时，在完成交易之后“购买订单”-“查看”的页面中增加“操作”栏目（申请退货，退货发货），增加一个“状态”（交易完成，申请退货，卖家通过退货，退货已发货，退货完成）。
- 申请退货之后等待卖方确认，卖方同意退货则进入退货流程
- 退货功能发起之后，进入退货页面，填写退货的物流信息，包括：快递名称，快递单号，退货地址。
- 退货信息填写完毕之后，“购买订单”-“查看”-里面对应图书状态下面显示“退货已发货”

- <u>**为实现这样的功能，首先在 t_orderitem 表中增加一个状态字段，0：交易完成，1：申请退货中，2：卖家同意退货，3：买家退货已发货，4：卖家收货退货完成，5：买家拒绝退货（进入退货仲裁），6：申请仲裁，7：仲裁失败**</u>
- <u>**进入管理员仲裁之后，如果仲裁通过，则直接进入仲裁退货状态，如果仲裁失败，直接进入仲裁失败状态**</u>

#### 2. 卖家 ####
- 买家发起退货之后，对应的“店铺订单”中订单状态显示“买家申请退货中”，对应的操作为“同意退货”，“驳回申请”，在“退货”这一栏目下面显示所有正在退货的订单。
- 卖家驳回买家退货申请中进入退货仲裁阶段，

- <u>**为实现这样的功能，在 t_seller_order 表中订单状态字段增加集中状态，之前状态为1：未付款，2：已付款但未发货，3：已发货未确认收货，4：确认收货了交易成功，5：已取消**</u>
- <u>**现增以下状态 6：买家申请退货，7：同意申请退货，8：退货已发货，9：退货成功 10,：拒绝退货申请，11,：申请仲裁，12：仲裁失败**</u>
- <u>**管理员对买家退货申请仲裁通过的话，则直接进入状态7：同意申请退货，如果仲裁失败的话，直接进行状态12：仲裁失败**</u>

#### 3. 管理员 ####
管理员主要变更就是增加了仲裁这一功能，甲方提出的与买方沟通在实际中很难商榷，所以为了简化实现步骤，由管理员直接决定仲裁通过或者驳回仲裁。

- <u>**管理员中添加一个“退货仲裁” 栏目，里面显示退货仲裁信息**</u>
- <u>**仲裁信息页面显示内容为：图书编号，申请冲裁时间，退款金额，退货理由，图书图片。**</u>
- <u>**仲裁信息页面包括仲裁状态（申请仲裁，仲裁结束），仲裁操作（同意退货，驳回退货）**</u>

### 六. 技术难题 ###
- 在买家看来，一个订单中可以包含几个图书购买条目，这几个条目可以属于几个卖家店铺。这样就导致订单的状态很难去定义，因为可能订单中几条条目分别属于不同的不同的状态（未发货，已发货，已收货，退货中）。
- 在退货的时候，我们很多时候仅仅对订单中某一条条目不满意，因此我们可能只想退订特定的购买条目（某一本书）。

### 七. 解决方法 ###
- 一个整体订单只有三种状态，未付款，已付款，已完成（所有子订单都收货）
- 将操作的最小级别定为一个订单条目（一个条目包含同一本书），即我们可以对订单中的子条目进行单独的操作（退货，申请仲裁）。这时需要将订单条目和卖家的订单条目进行绑定，因为修改买家订单条目状态的同时卖家订单条目的状态也会进行相应的变化。